@model IEnumerable<e_commerce.Models.AvisViewModelNomProdUser>

@{
    ViewBag.Title = "ListeaAvisAdmin";
}
@section Scripts{
    <script>
          $(document).ready(function () {
                  $('.btn-delete').click(function (event) {
                var btnClick = $(event.target).closest('button');
                var IdSupprimer = $(btnClick).attr('data-id');

                // Utiliser SweetAlert pour la confirmation de suppression
                Swal.fire({
                    title: 'Êtes-vous sûr ?',
                    text: "Voulez-vous vraiment supprimer ce produit ?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Oui, supprimer !',
                    cancelButtonText: 'Annuler'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Si l'utilisateur confirme la suppression
                        $.ajax({
                            url: '@Url.Action("Delete")',
                            type: 'POST',
                            data: { id: IdSupprimer },
                            success: function (data) {
                                if (data.suppression == "OK") {
                                    $(btnClick).closest('tr').fadeOut(400, function () {
                                        $(this).remove();
                                    });

                                    // Afficher une alerte de succès après la suppression
                                    Swal.fire(
                                        'Supprimé!',
                                        'Le produit a été supprimé avec succès.',
                                        'success'
                                    );
                                }
                            }
                        });
                    }
                });
            });

          })
    </script>
}
<div style="margin-top:30px;">
    @using GridMvc.Html
    @Html.Grid(Model).Columns(columns =>
    {
        columns.Add(a => a.idAvis).Titled("Id");
        columns.Add(a => a.commentaire).Titled("Commentaire");
        columns.Add(a => a.Note).Titled("Note");
        columns.Add(a => a.DateAvis).Titled("Date de l'avis").Filterable(true);
        columns.Add(a => a.Nomuser).Titled("Nom Utilisateur");
        columns.Add(a => a.NomProd).Titled("Nom Produit").Filterable(true);
        columns.Add()
        .Sanitized(false)
        .Encoded(false)
        .RenderValueAs(a => "<button class='btn btn-default btn-delete' data-id='" + a.idAvis + "'><span class='glyphicon glyphicon-remove'/></button>");
    }).WithPaging(10)
</div>